import{g as B,r as q,b9 as V,s as x,ba as $,am as I,V as R,v as A,j,an as w,ao as M,l as O,m as Q,ab as D,J as P,U as H,a$ as L,b3 as N,bb as T}from"./index-Dp0VQKUX.js";let p=0;const J={fullscreen:Boolean,noRouteFullscreenExit:Boolean},K=["update:fullscreen","fullscreen"];function z(){const a=B(),{props:y,emit:m,proxy:u}=a;let o,l,n;const r=q(!1);V(a)===!0&&x(()=>u.$route.fullPath,()=>{y.noRouteFullscreenExit!==!0&&f()}),x(()=>y.fullscreen,i=>{r.value!==i&&v()}),x(r,i=>{m("update:fullscreen",i),m("fullscreen",i)});function v(){r.value===!0?f():b()}function b(){r.value!==!0&&(r.value=!0,n=u.$el.parentNode,n.replaceChild(l,u.$el),document.body.appendChild(u.$el),p++,p===1&&document.body.classList.add("q-body--fullscreen-mixin"),o={handler:f},$.add(o))}function f(){r.value===!0&&(o!==void 0&&($.remove(o),o=void 0),n.replaceChild(u.$el,l),r.value=!1,p=Math.max(0,p-1),p===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),u.$el.scrollIntoView!==void 0&&setTimeout(()=>{u.$el.scrollIntoView()})))}return I(()=>{l=document.createElement("span")}),R(()=>{y.fullscreen===!0&&b()}),A(f),Object.assign(u,{toggleFullscreen:v,setFullscreen:b,exitFullscreen:f}),{inFullscreen:r,toggleFullscreen:v}}const G=j({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(a,{slots:y,emit:m}){const u=B(),o=q(null);let l=0;const n=[];function r(e){const d=typeof e=="boolean"?e:a.noErrorFocus!==!0,h=++l,g=(t,s)=>{m(`validation${t===!0?"Success":"Error"}`,s)},E=t=>{const s=t.validate();return typeof s.then=="function"?s.then(c=>({valid:c,comp:t}),c=>({valid:!1,comp:t,err:c})):Promise.resolve({valid:s,comp:t})};return(a.greedy===!0?Promise.all(n.map(E)).then(t=>t.filter(s=>s.valid!==!0)):n.reduce((t,s)=>t.then(()=>E(s).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return h===l&&g(!0),!0;if(h===l){const{comp:s,err:c}=t[0];if(c!==void 0&&console.error(c),g(!1,s),d===!0){const S=t.find(({comp:C})=>typeof C.focus=="function"&&D(C.$)===!1);S!==void 0&&S.comp.focus()}}return!1})}function v(){l++,n.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function b(e){e!==void 0&&P(e);const d=l+1;r().then(h=>{d===l&&h===!0&&(a.onSubmit!==void 0?m("submit",e):e?.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function f(e){e!==void 0&&P(e),m("reset"),H(()=>{v(),a.autofocus===!0&&a.noResetFocus!==!0&&i()})}function i(){L(()=>{if(o.value===null)return;(o.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(o.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1))?.focus({preventScroll:!0})})}N(T,{bindComponent(e){n.push(e)},unbindComponent(e){const d=n.indexOf(e);d!==-1&&n.splice(d,1)}});let F=!1;return w(()=>{F=!0}),M(()=>{F===!0&&a.autofocus===!0&&i()}),R(()=>{a.autofocus===!0&&i()}),Object.assign(u.proxy,{validate:r,resetValidation:v,submit:b,reset:f,focus:i,getValidationComponents:()=>n}),()=>O("form",{class:"q-form",ref:o,onSubmit:b,onReset:f},Q(y.default))}});export{G as Q,J as a,z as b,K as u};
