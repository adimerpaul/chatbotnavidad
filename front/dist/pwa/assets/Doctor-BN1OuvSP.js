import{_ as q,c as g,o as n,w as a,a as e,W as V,d as p,Z as b,a2 as v,a3 as E,a4 as U,t as h,f as u,aa as c,h as Q,Q as D,e as _,b as d}from"./index-DtrjSMhE.js";import{Q as C,a as y}from"./QTable-IqArLUCf.js";import{Q as w,a as f,c as x}from"./format-5VNOWvu6.js";import{Q as z}from"./QList-B2up_Waf.js";import{Q as N}from"./QBtnDropdown-U7_nFJaa.js";import{Q as H}from"./QForm-CWYFTefy.js";import{Q as B}from"./QSpace-6Q19n9Rl.js";import{Q as P}from"./QPage-xov83BU_.js";import{C as k}from"./ClosePopup-JfYVfMAs.js";import"./QSelect-BFduFYyd.js";import"./use-fullscreen-CY6H4LIO.js";import"./selection-CWMV0ikY.js";const S={data(){return{doctores:[],doctor:{},horario:{available_from:"",available_to:"",days:"",price:""},dialogDoctor:!1,dialogHorarios:!1,loading:!1,filter:"",columns:[{name:"actions",label:"Acciones",align:"center"},{name:"name",label:"Nombre",field:"name",align:"left"},{name:"specialty",label:"Especialidad",field:"specialty",align:"left"},{name:"horarios",label:"Horarios",field:"schedules",align:"left"}],columnsHorarios:[{name:"available_from",label:"Desde",field:"available_from",align:"left"},{name:"available_to",label:"Hasta",field:"available_to",align:"left"},{name:"days",label:"Días",field:"days",align:"left"},{name:"price",label:"Precio",field:"price",align:"right"},{name:"actions",label:"Acciones",align:"center"}]}},mounted(){this.doctoresGet()},methods:{actualizarPrecio(t){this.loading=!0,this.$axios.put(`doctor-schedules/${t.id}`,{price:t.price}).then(()=>{this.$alert.success("Precio actualizado")}).catch(l=>{this.$alert.error(l.response?.data?.message||"Error al actualizar precio")}).finally(()=>{this.loading=!1})},doctoresGet(){this.loading=!0,this.$axios.get("doctors").then(t=>{this.doctores=t.data.map(l=>({...l,schedules:(l.schedules||[]).map(m=>({id:m.id,available_from:m.available_from,available_to:m.available_to,days:m.days,price:m.price}))}))}).catch(t=>{this.$alert.error(t.response?.data?.message||"Error al obtener doctores")}).finally(()=>this.loading=!1)},doctorNuevo(){this.doctor={name:"",specialty:"",schedules:[]},this.dialogDoctor=!0},doctorEditar(t){this.doctor={...t},this.dialogDoctor=!0},doctorGuardar(){this.loading=!0,this.$axios.post("doctors",this.doctor).then(()=>{this.dialogDoctor=!1,this.$alert.success("Doctor creado"),this.doctoresGet()}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>this.loading=!1)},doctorActualizar(){this.loading=!0,this.$axios.put(`doctors/${this.doctor.id}`,this.doctor).then(()=>{this.dialogDoctor=!1,this.$alert.success("Doctor actualizado"),this.doctoresGet()}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>this.loading=!1)},doctorEliminar(t){this.$alert.dialog("¿Deseas eliminar este doctor?").onOk(()=>{this.loading=!0,this.$axios.delete(`doctors/${t}`).then(()=>{this.$alert.success("Doctor eliminado"),this.doctoresGet()}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>this.loading=!1)})},horariosGestionar(t){this.doctor={...t},this.horario={available_from:"",available_to:"",days:"",price:""},this.dialogHorarios=!0},guardarHorario(){this.loading=!0,this.$axios.post(`doctors/${this.doctor.id}/schedules`,this.horario).then(()=>{this.$alert.success("Horario guardado"),this.doctoresGet(),this.dialogHorarios=!1}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>this.loading=!1)},eliminarHorario(t){this.loading=!0,this.$axios.delete(`doctor-schedules/${t}`).then(()=>{this.$alert.success("Horario eliminado"),this.doctoresGet(),this.dialogHorarios=!1}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>this.loading=!1)}}},A={key:0},I={key:1,class:"text-grey"},L={class:"text-h6"},T={class:"text-right"},F={class:"text-h6"},M={class:"row q-col-gutter-sm"},O={class:"col-4"},j={class:"col-4"},W={class:"col-4"},Z={class:"col-4"},J={class:"col-8 flex items-center justify-end"};function K(t,l,m,R,r,i){return n(),g(P,{class:"q-pa-md"},{default:a(()=>[e(C,{rows:r.doctores,columns:r.columns,title:"Doctores",dense:"",flat:"",bordered:"","wrap-cells":"",filter:r.filter,"rows-per-page-options":[0]},{"top-right":a(()=>[e(u,{label:"Nuevo",icon:"add_circle_outline",color:"positive",onClick:i.doctorNuevo,class:"q-mr-sm",loading:r.loading,"no-caps":""},null,8,["onClick","loading"]),e(u,{label:"Actualizar",icon:"refresh",color:"primary",onClick:i.doctoresGet,loading:r.loading,"no-caps":""},null,8,["onClick","loading"]),e(c,{modelValue:r.filter,"onUpdate:modelValue":l[0]||(l[0]=o=>r.filter=o),label:"Buscar",dense:"",outlined:""},{append:a(()=>[e(p,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-horarios":a(o=>[e(y,{props:o},{default:a(()=>[o.row.schedules?.length?(n(),v("div",A,[(n(!0),v(E,null,U(o.row.schedules,(s,G)=>(n(),v("div",{key:G,class:"text-caption text-grey-8"},[e(p,{name:"schedule",size:"14px",class:"q-mr-xs"}),b(" "+h(s.days)+": "+h(s.available_from)+" - "+h(s.available_to),1)]))),128))])):(n(),v("div",I,"Sin horarios"))]),_:2},1032,["props"])]),"body-cell-actions":a(o=>[e(y,{props:o},{default:a(()=>[e(N,{label:"Opciones",dense:"","no-caps":"",color:"primary",size:"10px"},{default:a(()=>[e(z,null,{default:a(()=>[V((n(),g(w,{clickable:"",onClick:s=>i.doctorEditar(o.row)},{default:a(()=>[e(f,{avatar:""},{default:a(()=>[e(p,{name:"edit"})]),_:1}),e(f,null,{default:a(()=>[e(x,null,{default:a(()=>l[13]||(l[13]=[b("Editar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),V((n(),g(w,{clickable:"",onClick:s=>i.horariosGestionar(o.row)},{default:a(()=>[e(f,{avatar:""},{default:a(()=>[e(p,{name:"event"})]),_:1}),e(f,null,{default:a(()=>[e(x,null,{default:a(()=>l[14]||(l[14]=[b("Horarios")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),V((n(),g(w,{clickable:"",onClick:s=>i.doctorEliminar(o.row.id)},{default:a(()=>[e(f,{avatar:""},{default:a(()=>[e(p,{name:"delete"})]),_:1}),e(f,null,{default:a(()=>[e(x,null,{default:a(()=>l[15]||(l[15]=[b("Eliminar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),e(Q,{modelValue:r.dialogDoctor,"onUpdate:modelValue":l[5]||(l[5]=o=>r.dialogDoctor=o),persistent:""},{default:a(()=>[e(D,{style:{width:"400px"}},{default:a(()=>[e(_,null,{default:a(()=>[d("div",L,h(r.doctor.id?"Editar":"Nuevo")+" Doctor",1)]),_:1}),e(_,null,{default:a(()=>[e(H,{onSubmit:l[4]||(l[4]=o=>r.doctor.id?i.doctorActualizar():i.doctorGuardar())},{default:a(()=>[e(c,{modelValue:r.doctor.name,"onUpdate:modelValue":l[1]||(l[1]=o=>r.doctor.name=o),label:"Nombre",dense:"",outlined:"",rules:[o=>!!o||"Campo requerido"]},null,8,["modelValue","rules"]),e(c,{modelValue:r.doctor.specialty,"onUpdate:modelValue":l[2]||(l[2]=o=>r.doctor.specialty=o),label:"Especialidad",dense:"",outlined:"",rules:[o=>!!o||"Campo requerido"]},null,8,["modelValue","rules"]),d("div",T,[e(u,{label:"Cancelar",color:"negative",onClick:l[3]||(l[3]=o=>r.dialogDoctor=!1),"no-caps":""}),e(u,{label:"Guardar",color:"primary",type:"submit",class:"q-ml-sm","no-caps":"",loading:r.loading},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:r.dialogHorarios,"onUpdate:modelValue":l[12]||(l[12]=o=>r.dialogHorarios=o),persistent:""},{default:a(()=>[e(D,{style:{width:"600px","max-width":"90vw"}},{default:a(()=>[e(_,{class:"row items-center q-pb-none"},{default:a(()=>[d("div",F,"Horarios - "+h(r.doctor.name),1),e(B),e(u,{icon:"close",flat:"",round:"",dense:"",onClick:l[6]||(l[6]=o=>r.dialogHorarios=!1)})]),_:1}),e(_,null,{default:a(()=>[e(H,{onSubmit:l[11]||(l[11]=o=>i.guardarHorario())},{default:a(()=>[d("div",M,[d("div",O,[e(c,{modelValue:r.horario.available_from,"onUpdate:modelValue":l[7]||(l[7]=o=>r.horario.available_from=o),label:"Desde",type:"time",dense:"",outlined:"",required:""},null,8,["modelValue"])]),d("div",j,[e(c,{modelValue:r.horario.available_to,"onUpdate:modelValue":l[8]||(l[8]=o=>r.horario.available_to=o),label:"Hasta",type:"time",dense:"",outlined:"",required:""},null,8,["modelValue"])]),d("div",W,[e(c,{modelValue:r.horario.days,"onUpdate:modelValue":l[9]||(l[9]=o=>r.horario.days=o),label:"Días",dense:"",outlined:"",required:""},null,8,["modelValue"])]),d("div",Z,[e(c,{modelValue:r.horario.price,"onUpdate:modelValue":l[10]||(l[10]=o=>r.horario.price=o),modelModifiers:{number:!0},label:"Precio (Bs)",type:"number",dense:"",outlined:"",required:""},null,8,["modelValue"])]),d("div",J,[e(u,{color:"primary",label:"Guardar horario",icon:"add",type:"submit",dense:"","no-caps":""})])])]),_:1}),e(C,{rows:r.doctor.schedules||[],columns:r.columnsHorarios,dense:"",flat:"",bordered:"","row-key":"id",class:"q-mt-md","rows-per-page-options":[0]},{"body-cell-actions":a(o=>[e(y,{props:o},{default:a(()=>[e(u,{icon:"delete",color:"negative",dense:"",flat:"",round:"",onClick:s=>i.eliminarHorario(o.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-price":a(o=>[e(y,{props:o},{default:a(()=>[e(c,{modelValue:o.row.price,"onUpdate:modelValue":[s=>o.row.price=s,s=>i.actualizarPrecio(o.row)],modelModifiers:{number:!0},type:"number",dense:"",outlined:"",debounce:"800",style:{width:"90px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ne=q(S,[["render",K]]);export{ne as default};
